import tensorflow as tf
from math import pi
from strateobots.engine import BotType
from strateobots.ai.lib.data import state2vec, action2vec
from strateobots.ai.dqn_duel import functions


class QualityFunctionModel:
    def __init__(self):
        self.name = "crafted_formula"
        self.one_var = tf.get_variable("myvar", [])
        self.var_list = [self.one_var]

    def apply(self, state, action):
        return QualityFunction(self, state, action)


class QualityFunction(functions.all.QualityFunction):
    def __init__(self, model, state, action):
        """
        :param model: QualityFunctionModel
        :param state: [..., state_vector_len]
        :param action: [..., action_vector_len]
        """
        phi_b = state[..., state2vec[0, "orientation"]]
        phi_g = state[..., state2vec[0, "tower_orientation"]]
        w_b = BotType.Raider.rot_speed
        w_g = BotType.Raider.gun_rot_speed
        tps = 50
        frameskip = 2
        dt = (1 + frameskip) / tps
        a_b = (
            action[..., action2vec["rotate_right"]]
            - action[..., action2vec["rotate_left"]]
        )
        a_g = (
            action[..., action2vec["tower_rotate_right"]]
            - action[..., action2vec["tower_rotate_left"]]
        )

        phi = phi_b + phi_g + (a_b * w_b + a_g * w_g) * dt
        phi0 = tf.atan2(
            state[..., state2vec[1, "y"]] - state[..., state2vec[0, "y"]],
            state[..., state2vec[1, "x"]] - state[..., state2vec[0, "x"]],
        )
        alpha = ((phi - phi0 + pi) % (2 * pi)) - pi
        t_n = alpha / (w_b + w_g)
        t_l = 1 - state[..., state2vec[0, "load"]]
        k = (tf.maximum(t_n, t_l) + 0.2) / dt

        d = BotType.Raider.damage / BotType.Raider.max_hp
        h0 = state[..., state2vec[1, "hp_ratio"]]
        r0 = 1 - h0
        nu = tf.ceil(h0 / d)
        y = 0.95
        T = BotType.Raider.cd_period
        y_k = y ** k
        y_T = y ** T
        y_nT = y ** (nu * T)

        Qcur = r0 * (1 - y_k) / (1 - y)
        Qfut = r0 * (y_T - y_nT) / (1 - y_T)
        Qcum = d * y_T * (1 - (1 + nu - nu * y_T) * y_nT) / ((1 - y_T) ** 2)
        fut_koeff = y_k * (1 - y_T) / (1 - y)

        Q = Qcur + fut_koeff * (Qfut + Qcum)

        Q0 = (1 - h0) * (1 - y_k) / (1 - y)
        Qd = (
            d
            * y_k
            * y_T
            * (1 - (1 - nu * y_T + nu) * (y_T ** nu))
            / ((1 - y) * (1 - y_T))
        )
        # self.quality = 10 * (Q0 + Qd) + model.one_var
        self.quality = 10 * Q + model.one_var

        self.Qcur = Qcur
        self.Qfut = Qfut
        self.Qcum = Qcum
        self.fut_koeff = fut_koeff
        self.Q = Q

        self.q0 = Q0
        self.qd = Qd
        self.k = k

    def get_quality(self):
        return self.quality


def select_features(tensor, mapper, *feature_names):
    feature_tensors = []
    for ftr_name in feature_names:
        idx = mapper[ftr_name]
        feature_tensors.append(tensor[..., idx : idx + 1])
    return tf.concat(feature_tensors, -1)


if __name__ == "__main__":
    import numpy as np

    np.set_printoptions(linewidth=np.nan)
    sess = tf.Session()
    rp = 0.95
    rew = np.array(
        [
            7.4583316,
            7.4583316,
            7.4583316,
            7.4583316,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            8.574587,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            9.396737,
            10.516644,
            10.516644,
        ],
        dtype=np.float32,
    )
    st0 = np.array(
        [
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                8.3999997e-01,
                0.0000000e00,
                0.0000000e00,
                5.5717430e00,
                4.3416578e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                2.5416681e-01,
                8.1999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.7474117e00,
                4.4573689e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                8.9999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5498695e00,
                6.2687907e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                2.5416681e-01,
                8.8000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.6945963e00,
                3.6451858e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                9.5999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5694857e00,
                4.3081887e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                2.5416681e-01,
                9.4000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.6676354e00,
                3.8190448e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.5696216e00,
                6.2665710e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                2.5416681e-01,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                5.6997380e00,
                4.4006619e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.9999999e-02,
                0.0000000e00,
                0.0000000e00,
                5.5792618e00,
                4.0177517e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                2.5416681e-01,
                3.9999999e-02,
                0.0000000e00,
                0.0000000e00,
                5.7451363e00,
                5.7596219e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                1.2000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.5538321e00,
                6.2610936e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                1.0000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.8391037e00,
                8.1159830e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                1.8000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5744891e00,
                3.2218367e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                1.6000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.9637437e00,
                1.0025418e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                2.3999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5511756e00,
                6.2589035e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                2.2000000e-01,
                0.0000000e00,
                0.0000000e00,
                6.1162500e00,
                1.1074243e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                3.0000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5710721e00,
                3.2591436e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                2.8000000e-01,
                0.0000000e00,
                0.0000000e00,
                6.2230206e00,
                1.0617479e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                3.6000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5512996e00,
                6.2684894e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                3.4000000e-01,
                0.0000000e00,
                0.0000000e00,
                3.1351286e-04,
                1.0960009e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                4.1999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5739999e00,
                3.0527523e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                4.0000001e-01,
                0.0000000e00,
                0.0000000e00,
                6.2645035e00,
                1.0573788e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                4.7999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5518155e00,
                6.2594047e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                4.6000001e-01,
                0.0000000e00,
                0.0000000e00,
                2.0037959e-03,
                8.8117909e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.4000002e-01,
                0.0000000e00,
                0.0000000e00,
                5.5694871e00,
                3.1104388e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                5.1999998e-01,
                0.0000000e00,
                0.0000000e00,
                9.1235541e-02,
                8.3738512e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                6.0000002e-01,
                0.0000000e00,
                0.0000000e00,
                5.5695610e00,
                6.2579122e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                5.7999998e-01,
                0.0000000e00,
                0.0000000e00,
                2.1320398e-01,
                8.6095637e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                6.6000003e-01,
                0.0000000e00,
                0.0000000e00,
                5.5622706e00,
                2.8323425e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                6.3999999e-01,
                0.0000000e00,
                0.0000000e00,
                2.5106463e-01,
                9.7640806e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                7.2000003e-01,
                0.0000000e00,
                0.0000000e00,
                5.5662918e00,
                6.2492132e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                6.9999999e-01,
                0.0000000e00,
                0.0000000e00,
                1.9531620e-01,
                1.2164229e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                7.7999997e-01,
                0.0000000e00,
                0.0000000e00,
                5.5736489e00,
                1.5257353e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                7.5999999e-01,
                0.0000000e00,
                0.0000000e00,
                1.4036526e-01,
                1.2835897e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                8.3999997e-01,
                0.0000000e00,
                0.0000000e00,
                5.5591106e00,
                3.7823170e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                8.1999999e-01,
                0.0000000e00,
                0.0000000e00,
                1.6556442e-01,
                1.1633741e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                8.9999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5705132e00,
                6.2740121e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                8.8000000e-01,
                0.0000000e00,
                0.0000000e00,
                1.4689548e-01,
                1.1622342e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                9.5999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5580502e00,
                2.6940914e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                9.4000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.4461300e-02,
                1.0935910e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.5689301e00,
                6.2660937e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.2616262e00,
                1.0086069e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.9999999e-02,
                0.0000000e00,
                0.0000000e00,
                5.5541782e00,
                1.9715494e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.1562643e00,
                1.0735980e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                1.2000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.5633154e00,
                6.2576208e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0786214e00,
                1.2833023e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                1.8000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5657001e00,
                1.3617617e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                3.9999999e-02,
                0.0000000e00,
                0.0000000e00,
                6.0319476e00,
                1.5430015e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                2.3999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5742054e00,
                6.2478151e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                1.0000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.9592195e00,
                1.6168780e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                3.0000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5577712e00,
                8.7928670e-03,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                1.6000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.9432855e00,
                1.5117103e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                3.6000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5708985e00,
                7.5116731e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                2.2000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.9028778e00,
                1.3958560e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                4.1999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5577288e00,
                6.2699218e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                2.8000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.8535738e00,
                1.3340340e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                4.7999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5702715e00,
                6.2777543e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                3.4000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.7743564e00,
                1.4122289e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.4000002e-01,
                0.0000000e00,
                0.0000000e00,
                5.5586405e00,
                4.9468074e-03,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                4.0000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.7051268e00,
                1.5046804e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                6.0000002e-01,
                0.0000000e00,
                0.0000000e00,
                5.5723858e00,
                6.2414823e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                4.6000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.6621790e00,
                1.6847680e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                6.6000003e-01,
                0.0000000e00,
                0.0000000e00,
                5.5587039e00,
                6.2821345e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                5.1999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.6972327e00,
                1.7135088e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                7.2000003e-01,
                0.0000000e00,
                0.0000000e00,
                5.5705972e00,
                5.9764564e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                5.7999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.7346773e00,
                1.6838734e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                7.7999997e-01,
                0.0000000e00,
                0.0000000e00,
                5.5563807e00,
                6.2696838e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                6.3999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.7050347e00,
                1.5463675e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                8.3999997e-01,
                0.0000000e00,
                0.0000000e00,
                5.5649080e00,
                2.8636640e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                6.9999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.7178745e00,
                1.4276419e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                8.9999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5658631e00,
                6.2448926e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                7.5999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.7994280e00,
                1.3648679e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                9.5999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5690861e00,
                8.8596120e-03,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                8.1999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.8173480e00,
                1.4337043e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.5535536e00,
                2.3488825e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                8.8000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.7523680e00,
                1.6353359e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.9999999e-02,
                0.0000000e00,
                0.0000000e00,
                5.5642138e00,
                6.2503190e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                9.4000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.6908655e00,
                1.7981901e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                1.2000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.5740800e00,
                6.2259283e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                -5.1664334e-02,
                9.5999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.6657195e00,
                1.8133328e00,
            ],
        ],
        dtype=np.float32,
    )
    st1 = np.array(
        [
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                8.9999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5498695e00,
                6.2687907e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                2.5416681e-01,
                8.8000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.6945963e00,
                3.6451858e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                9.5999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5694857e00,
                4.3081887e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                2.5416681e-01,
                9.4000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.6676354e00,
                3.8190448e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.5696216e00,
                6.2665710e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                2.5416681e-01,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                5.6997380e00,
                4.4006619e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.9999999e-02,
                0.0000000e00,
                0.0000000e00,
                5.5792618e00,
                4.0177517e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                2.5416681e-01,
                3.9999999e-02,
                0.0000000e00,
                0.0000000e00,
                5.7451363e00,
                5.7596219e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                1.2000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.5538321e00,
                6.2610936e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                1.0000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.8391037e00,
                8.1159830e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                1.8000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5744891e00,
                3.2218367e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                1.6000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.9637437e00,
                1.0025418e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                2.3999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5511756e00,
                6.2589035e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                2.2000000e-01,
                0.0000000e00,
                0.0000000e00,
                6.1162500e00,
                1.1074243e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                3.0000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5710721e00,
                3.2591436e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                2.8000000e-01,
                0.0000000e00,
                0.0000000e00,
                6.2230206e00,
                1.0617479e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                3.6000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5512996e00,
                6.2684894e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                3.4000000e-01,
                0.0000000e00,
                0.0000000e00,
                3.1351286e-04,
                1.0960009e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                4.1999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5739999e00,
                3.0527523e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                4.0000001e-01,
                0.0000000e00,
                0.0000000e00,
                6.2645035e00,
                1.0573788e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                4.7999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5518155e00,
                6.2594047e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                4.6000001e-01,
                0.0000000e00,
                0.0000000e00,
                2.0037959e-03,
                8.8117909e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.4000002e-01,
                0.0000000e00,
                0.0000000e00,
                5.5694871e00,
                3.1104388e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                5.1999998e-01,
                0.0000000e00,
                0.0000000e00,
                9.1235541e-02,
                8.3738512e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                6.0000002e-01,
                0.0000000e00,
                0.0000000e00,
                5.5695610e00,
                6.2579122e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                5.7999998e-01,
                0.0000000e00,
                0.0000000e00,
                2.1320398e-01,
                8.6095637e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                6.6000003e-01,
                0.0000000e00,
                0.0000000e00,
                5.5622706e00,
                2.8323425e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                6.3999999e-01,
                0.0000000e00,
                0.0000000e00,
                2.5106463e-01,
                9.7640806e-01,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                7.2000003e-01,
                0.0000000e00,
                0.0000000e00,
                5.5662918e00,
                6.2492132e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                6.9999999e-01,
                0.0000000e00,
                0.0000000e00,
                1.9531620e-01,
                1.2164229e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                7.7999997e-01,
                0.0000000e00,
                0.0000000e00,
                5.5736489e00,
                1.5257353e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                7.5999999e-01,
                0.0000000e00,
                0.0000000e00,
                1.4036526e-01,
                1.2835897e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                8.3999997e-01,
                0.0000000e00,
                0.0000000e00,
                5.5591106e00,
                3.7823170e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                8.1999999e-01,
                0.0000000e00,
                0.0000000e00,
                1.6556442e-01,
                1.1633741e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                8.9999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5705132e00,
                6.2740121e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                8.8000000e-01,
                0.0000000e00,
                0.0000000e00,
                1.4689548e-01,
                1.1622342e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                9.5999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5580502e00,
                2.6940914e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                9.4000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.4461300e-02,
                1.0935910e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.5689301e00,
                6.2660937e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.2616262e00,
                1.0086069e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.9999999e-02,
                0.0000000e00,
                0.0000000e00,
                5.5541782e00,
                1.9715494e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.4254135e-01,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.1562643e00,
                1.0735980e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                1.2000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.5633154e00,
                6.2576208e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0786214e00,
                1.2833023e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                1.8000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5657001e00,
                1.3617617e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                3.9999999e-02,
                0.0000000e00,
                0.0000000e00,
                6.0319476e00,
                1.5430015e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                2.3999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5742054e00,
                6.2478151e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                1.0000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.9592195e00,
                1.6168780e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                3.0000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5577712e00,
                8.7928670e-03,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                1.6000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.9432855e00,
                1.5117103e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                3.6000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5708985e00,
                7.5116731e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                2.2000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.9028778e00,
                1.3958560e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                4.1999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5577288e00,
                6.2699218e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                2.8000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.8535738e00,
                1.3340340e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                4.7999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.5702715e00,
                6.2777543e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                3.4000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.7743564e00,
                1.4122289e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.4000002e-01,
                0.0000000e00,
                0.0000000e00,
                5.5586405e00,
                4.9468074e-03,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                4.0000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.7051268e00,
                1.5046804e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                6.0000002e-01,
                0.0000000e00,
                0.0000000e00,
                5.5723858e00,
                6.2414823e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                4.6000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.6621790e00,
                1.6847680e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                6.6000003e-01,
                0.0000000e00,
                0.0000000e00,
                5.5587039e00,
                6.2821345e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                5.1999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.6972327e00,
                1.7135088e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                7.2000003e-01,
                0.0000000e00,
                0.0000000e00,
                5.5705972e00,
                5.9764564e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                5.7999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.7346773e00,
                1.6838734e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                7.7999997e-01,
                0.0000000e00,
                0.0000000e00,
                5.5563807e00,
                6.2696838e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                6.3999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.7050347e00,
                1.5463675e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                8.3999997e-01,
                0.0000000e00,
                0.0000000e00,
                5.5649080e00,
                2.8636640e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                6.9999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.7178745e00,
                1.4276419e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                8.9999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5658631e00,
                6.2448926e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                7.5999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.7994280e00,
                1.3648679e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                9.5999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.5690861e00,
                8.8596120e-03,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                8.1999999e-01,
                0.0000000e00,
                0.0000000e00,
                5.8173480e00,
                1.4337043e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.5535536e00,
                2.3488825e-02,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                8.8000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.7523680e00,
                1.6353359e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                5.9999999e-02,
                0.0000000e00,
                0.0000000e00,
                5.5642138e00,
                6.2503190e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                6.0326256e-02,
                9.4000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.6908655e00,
                1.7981901e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                1.2000000e-01,
                0.0000000e00,
                0.0000000e00,
                5.5740800e00,
                6.2259283e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                -5.1664334e-02,
                9.5999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.6657195e00,
                1.8133328e00,
            ],
            [
                4.7728622e02,
                5.4454309e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                1.8000001e-01,
                0.0000000e00,
                0.0000000e00,
                5.5788350e00,
                6.2106137e00,
                5.4724078e02,
                4.8361987e02,
                0.0000000e00,
                0.0000000e00,
                1.0000000e00,
                0.0000000e00,
                0.0000000e00,
                -5.1664334e-02,
                9.5999998e-01,
                0.0000000e00,
                0.0000000e00,
                5.6657195e00,
                1.8133328e00,
            ],
        ],
        dtype=np.float32,
    )
    act = np.array(
        [
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
            [0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
        ],
        dtype=np.float32,
    )

    class DummyModel:
        one_var = 0

    qf = QualityFunction(DummyModel(), st0, act)
    q1 = sess.run(qf.get_quality())

    q0 = np.zeros_like(rew)
    assert rew[-1] > 10
    for i in range(rew.size - 1, -1, -1):
        if rew[i] > 10:
            q0[i] = rew[i]
        else:
            q0[i] = rew[i] + rp * q0[i + 1]
    import code

    code.interact(local=globals())
